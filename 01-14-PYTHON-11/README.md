## Задачи из юнитов модуля PYTHON-11 (Pandas) ##

#### **Задание 2.3** ####

Написать функцию `delete_columns(df, col=[])`, которая удаляет столбцы из
DataFrame и возвращает новую таблицу. Если одного из указанных столбцов не
существует в таблице, то функция должна возвращать `None`.    
Удалит выбранные столбцы из таблицы `customer_df`.    
***Подсказка:***    
Для удаления столбцов используется метод `drop()` с параметром `axis=1`. В него
передаётся список столбцов, подлежащих удалению.

```python
import pandas as pd

def delete_columns(df, col=[]):
    if len(col) == 0:
        return None
    colset = set(col)
    if colset.issubset(set(df.columns)):
        newdf = df.drop(col, axis=1)
        return newdf
    else:
        return None


if __name__ == '__main__':
    customer_df = pd.DataFrame({
        'number': [0, 1, 2, 3, 4],
        'cust_id': [128, 1201, 9832, 4392, 7472],
        'cust_age': [13, 21, 19, 21, 60],
        'cust_sale': [0, 0, 0.2, 0.15, 0.3],
        'cust_year_birth': [2008, 2000, 2002, 2000, 1961],
        'cust_order': [1400, 14142, 900, 1240, 8430]
    })
    columns_for_delete= ['number', 'cust_id', 'cust_age']
    new_df = delete_columns(customer_df, columns_for_delete)
    print(new_df)
#   cust_sale  cust_year_birth  cust_order
# 0       0.00             2008        1400
# 1       0.00             2000       14142
# 2       0.20             2002         900
# 3       0.15             2000        1240
# 4       0.30             1961        8430
```

----

#### **Задание 2.4** ####

Задан DataFrame `countries_df`, содержащий следующие столбцы: название страны
(`country`), население (`population`) в миллионах человек и площадь страны
(`square`) в квадратных километрах.

```text
import pandas as pd
countries_df = pd.DataFrame({
    'country': ['Англия', 'Канада', 'США', 'Россия', 'Украина', 'Беларусь', 'Казахстан'],
    'population': [56.29, 38.05, 322.28, 146.24, 45.5, 9.5, 17.04],
    'square': [133396, 9984670, 9826630, 17125191, 603628, 207600, 2724902]
})
```

Для каждой страны рассчитать плотность населения (количество человек на
квадратный километр). Затем по полученным данным рассчитать среднее по
плотностям населения в указанных странах. Население в таблице представлено в
миллионах. Ответ округлить до сотых.

```python
density = countries_df['population'] * 1_000_000 / countries_df['square']
print(round(density.mean(), 2))
# 84.93
```

----

#### **Задание 4.4** ####

Идёт подготовка данных о вакансиях с платформы **hh.ru**. В распоряжении имеется
таблица, в которой с помощью парсинга собраны резюме кандидатов. В этой таблице
есть текстовый столбец **&laquo;Опыт работы&raquo;**. Пример такого столбца
представлен ниже в виде объекта **Series**. Структура текста в столбце
фиксирована и не может измениться.    
Написать функцию `get_experience(arg)`, аргументом которой является строка
столбца с опытом работы. Функция должна возвращать опыт работы в месяцах. Не
забыть привести результат к целому числу.    
Обратить внимание, что опыт работы может выражаться только в годах или только в
месяцах. Учесть это при построении своей функции. Кроме того, учесть возможные
вариации слов месяц (месяца, месяцев) и год (года, лет).    
Применить функцию к **Series** `experience_col` с помощью метода `apply()`.    
***Пример результата работы функции `get_experience`:***    
**`INPUT:`**

```text
0        'Опыт работы 8 лет 3 месяца',
1        'Опыт работы 3 года 5 месяцев',
2        'Опыт работы 1 год 9 месяцев',
3        'Опыт работы 3 месяца',
4        'Опыт работы 6 лет'
dtype: object
```

**`OUTPUT:`**

```text
0        99
1        41
2        21
3        3
4        72
dtype: int64
```

```python
import pandas as pd

def get_experience(arg):
    arg_list = arg.split()
    if len(arg_list) == 6:
        month_num = int(arg_list[2]) * 12 + int(arg_list[4])
    else:
        if arg_list[3][0] == 'м':
            month_num = int(arg_list[2])
        else:
            month_num = int(arg_list[2]) * 12
    return month_num


if __name__ == '__main__':
    experience_col = pd.Series([
        'Опыт работы 8 лет 3 месяца',
        'Опыт работы 3 года 5 месяцев',
        'Опыт работы 1 год 9 месяцев',
        'Опыт работы 3 месяца',
        'Опыт работы 6 лет'
        ])
    experience_month = experience_col.apply(get_experience)
    print(experience_month)
```
