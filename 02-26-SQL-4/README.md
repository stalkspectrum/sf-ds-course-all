## Задачи из юнитов модуля SQL-4 (Сложные объединения) ##

### Схема базы sql.city ###

    city_id     INTEGER     уникальный идентификатор города, первичный ключ
    city_name   TEXT        название города
    state       TEXT        штат, к которому относится город
    population  INTEGER     население города
    area        NUMERIC     площадь города

----

### Схема базы sql.customer ###

    cust_id         INTEGER     уникальный идентификатор клиента, первичный ключ
    cust_name       TEXT        название клиента
    annual_revenue  NUMERIC     ежегодная выручка
    cust_type       TEXT        тип пользователя
    address         TEXT        адрес
    zip             INTEGER     почтовый индекс
    phone           TEXT        телефон
    city_id         INTEGER     идентификатор города, внешний ключ к таблице city

----

### Схема базы sql.driver ###

    driver_id       INTEGER     уникальный идентификатор водителя, первичный ключ
    first_name      TEXT        имя водителя
    last_name       TEXT        фамилия водителя
    address         TEXT        адрес водителя
    zip_code        INTEGER     почтовый индекс водителя
    phone           TEXT        телефон водителя
    city_id         INTEGER     идентификатор города водителя, внешний ключ
                                к таблице city

----

### Схема базы sql.truck ###

    truck_id    INTEGER     Уникальный идентификатор грузовика, первичный ключ
    make        TEXT        Производитель грузовика
    model_year  INTEGER     Дата выпуска грузовика

----

### Схема базы sql.shipment ###

    ship_id     INTEGER     уникальный идентификатор доставки, первичный ключ
    cust_id     INTEGER     идентификатор клиента, которому отправлена доставка,
                            внешний ключ к таблице customer
    weight      NUMERIC     вес посылки
    truck_id    INTEGER     идентификатор грузовика, на котором отправлена доставка,
                            внешний ключ к таблице truck
    driver_id   INTEGER     идентификатор водителя, который осуществлял доставку,
                            внешний ключ к таблице driver
    city_id     INTEGER     идентификатор города в который совершена доставка,
                            внешний ключ к таблице city
    ship_date   DATE        дата доставки

----

#### **Задание 2.1** ####

Написать запрос, который создает уникальный алфавитный справочник всех городов,
штатов, имён водителей и производителей грузовиков. Результатом запроса должны
быть два столбца: название и тип объекта (`city`, `state`, `driver`, `truck`).    
Отсортировать список по названию объекта, а затем&nbsp;&mdash; по типу.

```sql
SELECT
```

----

#### **Задание 2.2** ####

Написать запрос, который соберёт имена всех упомянутых городов и штатов с
таблицы **city**. Результатом запроса должен быть один столбец `object_name`,
отсортированный в алфавитном порядке.

----

#### **Задание 2.3** ####

Выполнив предыдущий запрос, получены города с одинаковыми названиями, но
находящиеся в разных штатах, а также большое количество дублирующихся названий
штатов.    
Переписать предыдущий запрос так, чтобы остались только уникальные названия
городов и штатов. Результатом запроса должен быть один столбец `object_name`,
отсортированный в алфавитном порядке.

----
